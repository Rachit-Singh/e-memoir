#:kivy 2.0.0
<SetPasswordDialogBox>
    orientation: "vertical"
    spacing: "12dp"
    size_hint_y: None
    height: "120dp"

    MDTextField:
        id: first_password
        password: True
        hint_text: "Password"

    MDTextField:
        id: confirm_password
        password: True
        hint_text: "Confirm Password"

<RemovePasswordDialogBox>
    orientation: "vertical"
    spacing: "12dp"
    size_hint_y: None
    height: "60dp"

    MDTextField:
        id: remove_current_password
        password: True
        hint_text: "Password"

<ChangePasswordDialogBox>
    orientation: "vertical"
    spacing: "12dp"
    size_hint_y: None
    height: "200dp"

    MDTextField:
        id: old_password
        password: True
        hint_text: "Password"

    MDTextField:
        id: new_password
        password: True
        hint_text: "New Password"


    MDTextField:
        id: confirm_new_password
        password: True
        hint_text: "Confirm Password"

Screen:
    MDNavigationLayout:
        ScreenManager:
            id: screen_manager
            Screen:
                name: "login_screen"
                BoxLayout:
                    orientation: 'vertical'
                    spacing: "40dp"

                    MDToolbar:
                        title: "E-Memoir"
                        elevation: 15

                    Widget: 

                    Image:
                        source: "Diary-icon.png"
                        size_hint: (0.8, 0.8)
                        pos_hint: {'center_x':0.5, 'center_y': 0.5}

                    BoxLayout:
                        orientation: 'vertical'
                        spacing: "10dp"
                        padding: "10dp"

                        MDTextField:
                            id: password_textField
                            password: True
                            hint_text: "Password"
                            icon_right: "account-key"
                            icon_right_color: app.theme_cls.primary_color
                            pos_hint: {'center_x':0.5, 'center_y': 0.5}
                            size_hint: (0.8, 0)

                        MDRectangleFlatButton:
                            text: 'Login'
                            pos_hint: {'center_x':0.5, 'center_y': 0.8}
                            on_release: app.credential_check()
                                
            Screen:
                name: "write_screen"
                BoxLayout:
                    orientation: 'vertical'
                    spacing: "40dp"
                    
                    MDToolbar:
                        title: "Write"
                        elevation: 15
                        left_action_items: [['menu', lambda x: nav_drawer.set_state('toggle')]]

                    Widget: 
                        size_hint: (0.01, 0.01)

                    BoxLayout :
                        orientation: 'vertical'
                        spacing: "50dp"

                        MDRaisedButton:
                            id: date_button
                            text: 'date_comes_here'
                            pos_hint: {"center_x":0.5, "center_y":0.2}
                            on_release: app.show_date_picker("date_button")

                        MDTextField:
                            id: memoir_textField
                            text: ""
                            pos_hint: {"center_x":0.5, "center_y":0.5}
                            multiline: True
                            hint_text: "What's on your mind"
                            color_mode: 'accent'
                            icon_right: "brain"
                            icon_right_color: app.theme_cls.primary_color
                            size_hint: (0.8, 0)

                        MDFloatingActionButton:
                            icon: "content-save"
                            pos_hint: {"center_x": 0.5, "center_y": 0.5}
                            on_release: app.save_memoir()
                            elevation_normal: 15

                        MDBottomAppBar:
                            MDToolbar:
                                title: "E-Memoir"
                                mode: "end"
                                type: "bottom"
                                icon: "exit-to-app"
                                on_action_button: app.confirm_exit()
                                left_action_items: [["book", lambda x: app.nothing()]]
                        

            Screen:
                name: "read_screen"
                BoxLayout:
                    orientation: "vertical"
                    spacing: "10dp"
                    
                    MDToolbar:
                        title: "Read"
                        elevation: 15
                        left_action_items: [['menu', lambda x: nav_drawer.set_state('toggle')]]

                    Widget:
                        size_hint: (0.01, 0.01)

                    BoxLayout :
                        size_hint: (0.9, 0.7)
                        pos_hint: {'center_x':0.5, 'center_y':0.5}
                        orientation: "vertical"
                        spacing: "10dp"
                        padding: "40dp"

                        MDTextField :
                            id: search_keyword
                            text: ""
                            hint_text: "Search by Keyword"
                            pos_hint: {"center_x":0.5, "center_y":0.2}
                            size_hint: (0.9, 0)
                            color_mode: 'accent'
                            icon_right: "brain"
                            icon_right_color: app.theme_cls.primary_color

                        MDLabel:
                            text: "Search in Date Range"
                            pos_hint: {"center_x":0.7, "center_y":0.5}
                            
                        MDRaisedButton:
                            id: from_date_read
                            text: 'date_comes_here'
                            pos_hint: {"center_x":0.5, "center_y":0.5}
                            on_release: app.show_date_picker("from_date_read")

                        MDRaisedButton:
                            id: to_date_read
                            text: 'date_comes_here'
                            pos_hint: {"center_x":0.5, "center_y":0.5}
                            on_release: app.show_date_picker("to_date_read")
                        
                        MDFloatingActionButton:
                            icon: "glasses"
                            pos_hint: {"center_x": 0.5, "center_y": 0.5}
                            on_release: app.read_memoir()
                            elevation_normal: 15

                    MDBottomAppBar:
                        MDToolbar:
                            title: "E-Memoir"
                            mode: "end"
                            type: "bottom"
                            icon: "exit-to-app"
                            on_action_button: app.confirm_exit()
                            left_action_items: [["book", lambda x: app.nothing()]]


            Screen:
                name: "delete_screen"
                BoxLayout:
                    orientation: 'vertical'
                    spacing: "0dp"
                    
                    MDToolbar:
                        title: "Delete"
                        elevation: 15
                        left_action_items: [['menu', lambda x: nav_drawer.set_state('toggle')]]

                    Widget:
                        size_hint: (0.01, 0.01)

                    BoxLayout :
                        orientation: "vertical"
                        spacing: "50dp"

                        MDRaisedButton:
                            id: deletion_option
                            text: "CRITERIA: DELETE ALL"
                            pos_hint: {"center_x":0.5, "center_y":0.5}
                            on_release: app.menu.open()

                        MDRaisedButton:
                            id: from_date_delete
                            text: 'date_comes_here'
                            pos_hint: {"center_x":0.5, "center_y":0.5}
                            on_release: app.show_date_picker("from_date_delete")

                        MDRaisedButton:
                            id: to_date_delete
                            text: 'date_comes_here'
                            pos_hint: {"center_x":0.5, "center_y":0.5}
                            on_release: app.show_date_picker("to_date_delete")

                        MDFloatingActionButton:
                            icon: "delete"
                            md_bg_color: (1, 0.2, 0.2, 1)
                            pos_hint: {"center_x": 0.5, "center_y": 0.5}
                            on_release: app.delete_memoir()
                            elevation_normal: 15

                        MDBottomAppBar:
                            MDToolbar:
                                title: "E-Memoir"
                                mode: "end"
                                type: "bottom"
                                icon: "exit-to-app"
                                on_action_button: app.confirm_exit()
                                left_action_items: [["book", lambda x: app.nothing()]]
            

            Screen:
                name: "settings_screen"
                BoxLayout:
                    orientation: 'vertical'
                    spacing: "10dp"

                    MDToolbar:
                        title: "E-Memoir"
                        elevation: 15
                        left_action_items: [['menu', lambda x: nav_drawer.set_state('toggle')]]

                    Widget:
                        size_hint: (0.01, 0.01)

                    BoxLayout :
                        orientation: "vertical"
                        spacing: "20dp"
                        padding: "40dp"

                        MDRaisedButton:
                            id: theme_picker
                            text: 'Theme'
                            pos_hint: {"center_x":0.5, "center_y":0}
                            on_release: app.show_theme_picker()

                        BoxLayout:
                            orientation: "horizontal"
                            id: password_btns_layout
                            spacing: "10dp"

                    MDBottomAppBar:
                        MDToolbar:
                            title: "E-Memoir"
                            mode: "end"
                            type: "bottom"
                            icon: "exit-to-app"
                            on_action_button: app.confirm_exit()
                            left_action_items: [["book", lambda x: app.nothing()]]

            Screen:
                name: "deletion_preview_screen"
                BoxLayout:
                    orientation: 'vertical'
                    spacing: "30dp"

                    MDToolbar:
                        title: "Check what to delete"
                        elevation: 15
                        left_action_items: [['arrow-left', lambda x: app.screen_change("delete_screen")]]

                    Widget :
                        size_hint: (0.01, 0.01)

                    BoxLayout:
                        orientation: "vertical"
                        id: deletion_table_here
                        size_hint: (0.99, 0.7)
                        
                    MDFloatingActionButton:
                        icon: "delete"
                        md_bg_color: (1, 0.2, 0.2, 1)
                        pos_hint: {"center_x": 0.5, "center_y": 0.5}
                        on_release: app.deleteInRange_warning()
                        elevation_normal: 15

            Screen:
                name: "reading_preview_screen"
                BoxLayout:
                    orientation: 'vertical'
                    spacing: "0dp"

                    MDToolbar:
                        title: "Tap item to expand"
                        elevation: 15
                        left_action_items: [['arrow-left', lambda x: app.screen_change("read_screen")]]

                    Widget :
                        size_hint: (0.01, 0.01)
                    ScrollView:
                        MDList:
                            id: reading_list_here

            Screen:
                name: "long_memoir_reading_screen"
                BoxLayout:
                    orientation: "vertical"
                    spacing: "0dp"

                    MDToolbar:
                        title: "Memoir"
                        elevation: 15
                        left_action_items: [['arrow-left', lambda x: app.screen_change("reading_preview_screen")]]
                    Widget :
                        size_hint: (0.01, 0.01)

                    BoxLayout:
                        orientation: "vertical"
                        padding: "20dp"
                        spacing: "20dp"
                        ScrollView:
                            MDLabel:
                                id: message_message_here
                                #halign: "left"
                                size_hint_y: None     # <<<<<<<<<<
                                height: self.texture_size[1]
                                text: ""
                                markup: True
                                pos_hint: {'center_x':0.5, 'center_y':0.8}

                        MDFloatingActionButton:
                            icon: "delete"
                            md_bg_color: (1, 0.2, 0.2, 1)
                            on_release: app.deletion_confirmation()
                            pos_hint: {'center_x':0.5, 'center_y':0.5}


        MDNavigationDrawer:
            id: nav_drawer
            orientation: "vertical"
            padding: "20dp"
            spacing: "20dp"
            
            AnchorLayout :
                pos_hint: {"center_x": 0.5, "center_y":0.5}
                Image:
                    id: avatar
                    source: "Diary-icon.png"

            ScrollView:
                MDList:
                    TwoLineIconListItem:
                        text: "Write"
                        on_release: 
                            nav_drawer.set_state("close")
                            screen_manager.current = "write_screen"
                        IconLeftWidget:
                            icon: "typewriter"
                    TwoLineIconListItem:
                        text: "Read"
                        on_release: 
                            nav_drawer.set_state("close")
                            screen_manager.current = "read_screen"
                        IconLeftWidget:
                            icon: "glasses"
                    TwoLineIconListItem:
                        text: "Delete"
                        on_release: 
                            nav_drawer.set_state("close")
                            screen_manager.current = "delete_screen"
                        IconLeftWidget:
                            icon: "delete"
                    TwoLineIconListItem:
                        text: "Settings"
                        on_release: 
                            nav_drawer.set_state("close")
                            screen_manager.current = "settings_screen"
                        IconLeftWidget:
                            icon: "wrench"
